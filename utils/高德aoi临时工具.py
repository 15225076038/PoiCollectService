from utils.GisTransformer import GisTransformer
from shapely.geometry import Polygon

gis = GisTransformer("gcj02", "wgs84")
url = "https://www.amap.com/detail/get/detail?id=B0FFGXD5EZ"
shape = "122.975128,41.119426;122.975139,41.119406;122.975135,41.119382;122.975124,41.119357;122.974423,41.118172;122.974235,41.117876;122.974208,41.117852;122.974187,41.117842;122.97416,41.11784;122.974131,41.11784;122.972866,41.11824;122.972819,41.118256;122.972798,41.118272;122.972788,41.118309;122.972795,41.118352;122.972818,41.118403;122.973968,41.11979;122.973984,41.119798;122.974014,41.119799;122.974049,41.11979;122.975098,41.119448;122.975128,41.119426"
aoi = [list(gis.transform_func(*list(map(float, poi.split(','))))) for poi in shape.split(';')]
print(Polygon(aoi).wkt)
print(aoi)

"""
update poi set aoi='POLYGON ((116.4615014319568 39.9926678315015, 116.4619218145144 39.99274290801592, 116.4619850251545 39.99273607102395, 116.4620131194292 39.9927281437097, 116.4620372011575 39.99271420632805, 116.4620833639365 39.99263932841385, 116.4621074567046 39.99253839473447, 116.4623312406472 39.99222498536779, 116.4630717932452 39.99160393124519, 116.4630818305411 39.99157495856555, 116.4630899595835 39.99076601333692, 116.4630779278043 39.99069798485443, 116.4630618772751 39.99067194417808, 116.4630197406012 39.9906358360833, 116.4626946796233 39.99042400086351, 116.4626525382367 39.9904288914303, 116.4623364575104 39.99064006477305, 116.4623234086488 39.99068302927731, 116.4623022911454 39.99105795915921, 116.4622891989815 39.9914439093007, 116.4622771544874 39.99147887674187, 116.4622631059717 39.99149283988599, 116.4615677400278 39.991962030946, 116.4615316159455 39.99199893677874, 116.4614412833672 39.99226969400343, 116.4614492675559 39.99260470047518, 116.4614502661954 39.99264170148835, 116.4615014319568 39.9926678315015))' where uid='08f1f1f529ffb6d389db73bd';

insert into poi ( uid, poi,aoi, tag,name,geohash,province,area,district ) values ('504d6113f73c70aa475726ad','POINT( 116.41361525876783 39.896862068961134)','POLYGON ((116.4127112204928 39.89770335047449, 116.4127735036246 39.89597047450989, 116.41278351741 39.89594148319099, 116.4128075447116 39.8959175019707, 116.4128626034533 39.89589354369559, 116.4129196617268 39.8958905860864, 116.4143982203822 39.89593572984894, 116.4144652932485 39.89594378377947, 116.4144863151855 39.89595380038378, 116.4145163459671 39.89597282392417, 116.4145193463618 39.89599582532113, 116.414425015479 39.89777866823809, 116.414408992118 39.89782365325325, 116.414381959342 39.89784763033484, 116.4143278983698 39.89786058617432, 116.4135210350342 39.89784095218425, 116.4127112204928 39.89770335047449))
','购物;购物中心','国瑞购物中心','wx4fcp1b','北京市','北京市','东城区');
"""
